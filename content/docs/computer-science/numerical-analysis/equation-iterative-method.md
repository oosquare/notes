---
title: 方程的迭代解法
weight: 200
math: true
---

- **确定初值**
    - **画图法**
    - **扫描法**
        - 在有根区间中，选定一个步长 $h$，用[零点定理](/docs/mathematics/calculus/function#fkxb1e)确定当前区间 $[x_0,x_0 + h]$ 内是否有根，并令 $x_0 \longleftarrow x_0 + h$，判断下一个区间。
        - 如果 $h$ 过大可能漏掉根，如果过小则计算量大。
    - **二分法**
        - 不断切分当前区间 $[a,b]$，进入有根的子区间，并继续寻找。
        - 切分 $n$ 次后，最终子区间长度为 $\dfrac{b - a}{2^n}$，方法误差 $|\Delta x_n| \le \dfrac{b - a}{2^n}$。
        - 如果要求 $|\Delta x_n| \le \varepsilon$，则 $n \ge \log_2\dfrac{b - a}{\varepsilon} = \dfrac{\ln(b - a) - \ln \varepsilon}{\ln 2}$。
        - 二分法无法求复根以及偶重根。
- **迭代方法**
    - **迭代计算**
        - 已知方程 $f(x) = 0$，则将其变换为 $x = \varphi(x)$，则 $x_{n + 1} = \varphi(x_n)$ 是迭代公式。 <span id="hx4z72"></span>
        - 从初值 $x_0$ 开始，得到 $x_1 = \varphi(x_0),x_2 = \varphi(x_1),\dots$，则 $x_0,x_1,x_2,\dots$ 是迭代序列。
        - 如果 $\lim\limits_{n \to +\infty} x_n = \alpha$ 存在，则 $\alpha$ 就是方程的根。如果发散，则这种迭代法失效。
    - **收敛性**
        - **类型**
            - 大范围收敛：任意位置都可以收敛。
            - 局部收敛：收敛速度更块，但需要初值接近根。
        - **收敛的充分条件**
            - 如果在 $[a, b]$ 上 $\varphi(x)$ [可导](/docs/mathematics/calculus/derivative#ri73aj)，且满足 $|\varphi'(x)| \le q < 1$，则迭代过程收敛。
            - $q$ 在此处保证 $|\varphi'(x)|$ 不是收敛于 $1$。
            - $q$ 越小则收敛越快。
            - 实际应用中，$[a,b]$ 长度较小，$|\varphi'(x)|$ 变化较小，所以只判断 $|\varphi(x_0)|<1$。
        - **收敛速度**
            - 如果存在正数 $r,c$ 满足 $\lim\limits_{n \to +\infty} \dfrac{|x_{n+1} - a|}{|x_n - a|^r} = c$，则其 $r$ 阶收敛。
    - **终止条件**
        - 迭代终止条件为 $|x_n - \alpha| < \varepsilon$，但需要估计一个 $|x_n - \alpha|$ 的上界来解决 $\alpha$ 未知的问题。
        - 常用上界公式：
            - $|x_n - \alpha| \le \dfrac{q}{1 - q}|x_n - x_{n - 1}|$，对于 $q\le 0.5$ 时，可以用 $|x_n - \alpha| \le |x_n - x_{n - 1}|$ 替代。
            - $|x_n - \alpha| \le \dfrac{q^n}{1 - q}|x_1 - x_0|$，该公式可以估计 $n$。
            - $|x_n - \alpha| \le \dfrac{|\varphi(x_n)|}{m},m \le |\varphi'(x)|$。
    - **误差分析**
        - 上界公式确定[截断误差](/docs/computer-science/numerical-analysis/numerical-compution-error#fmii73)。
        - 迭代方法的[舍入误差](/docs/computer-science/numerical-analysis/numerical-compution-error#slzgdw)只计算最后一次迭代产生的误差。
- **常用迭代公式**
    - **构造迭代公式**
        - **构造法 1**
            - 已知方程 $x = \varphi(x)$，引入参数 $\theta$ 并变换得到 $x - \theta x = \varphi(x) - \theta x$。
            - 整理并构造一个迭代公式 $x_{n + 1} = \dfrac{1}{1 - \theta}(\varphi(x) - \theta x) = \psi(x)$。
            - 通过选取 $\theta \approx \psi'(x)$，可以使该迭代公式的 $|q|$ 较小。
        - **构造法 2**
            - 已知方程 $f(x) = 0$，构造迭代公式 $x_{n + 1} = x_n - \lambda f(x_n)$ 。
        - **反函数法**
            - 如果 $|\varphi'(x)|>1$，则可以构造 $\varphi(x)$ 的反函数 $\psi(x)$，变换迭代公式为 $x = \psi(x)$，并且满足收敛条件。
    - **经典公式**
        - **埃特金法**
            - 埃特金法基于构造法 1。
            - 对于方程 $x = \varphi(x)$，首先选定初值 $x_0$，按照以下方式迭代：
                - 已知当前为 $x_n$，计算 $y_{n + 1} = \varphi(x_n)$ 和 $z_{n + 1} = \varphi(y_{n + 1}) = \varphi(\varphi(x_n))$。
                - 计算 $\theta_n = \dfrac{z_{n + 1} - y_{n + 1}}{y_{n + 1} - x_n}$。
                - 得出 $x_{n + 1} = \dfrac{1}{1 - \theta_n}\left(\varphi(x_n) - \theta_n x_n\right) = \dfrac{x_n z_{n + 1} - y_{n + 1}^2}{x_n - 2y_{n + 1} + z_{n + 1}}$。
            - 整理后的迭代公式：$x_{n + 1} = \dfrac{x_n \varphi(\varphi(x_n)) - (\varphi(x_n))^2}{x_n - 2\varphi(x_n) + \varphi(\varphi(x_n))}$。
            - 埃特金法的几何意义是用割线代替曲线 $y = \varphi(x)$ 求与 $y = x$ 的交点。
            - 收敛阶为 $2$。
        - **牛顿法**
            - 牛顿法基于构造法 2，选取 $\lambda = \dfrac{1}{f'(x_n)}$，迭代公式为 $x_{n + 1} = x_n - \dfrac{f(x_n)}{f'(x_n)}$。
            - 牛顿法的几何意义是用切线代替曲线求与 $x$ 轴交点，又叫切线法。
            - 牛顿法在 $[a,b]$ 内的收敛条件：
                - $f(x)$ 在 $[a,b]$ 内二阶可导；
                - $f(a)f(b) < 0$；
                - $f'(x) \ne 0$，$f''(x)$ 不变号；
                - $f(x_0)f''(x_0) > 0$。
            - 牛顿法对初值敏感，如果初值靠近根，则求解快速，否则不容易收敛。
            - 收敛阶为 $2$。
        - **简化切线法**
            - 基于构造法 2，选取 $\lambda = \dfrac{1}{f'(x_0)}$，迭代公式为 $x_{n + 1} = x_n - \dfrac{f(x_n)}{f'(x_0)}$。
            - 切线固定为初值处的切线。
        - **修正切线法**
            - 基于构造法 2 和简化切线法，每迭代 $m$ 次，重新选取当前 $x_n$ 处的切线斜率作为 $\lambda$。
        - **牛顿下山法**
            - 定义下山条件为 $|f(x)| > |f(x_1)| > |f(x_2)| > \cdots$，牛顿下山法要求迭代的 $x$ 需要满足下山条件以保证收敛。
            - 引入下山因子 $\tilde\lambda$，迭代公式改为 $x_{n + 1} = x_n - \tilde\lambda\dfrac{f(x_n)}{f'(x_n)}$。
            - 对于某个 $\tilde\lambda$，如果迭代出的下一个 $x$ 不满足下山条件，则不断缩小 $\tilde\lambda$（一般除以 $2$），直到满足。
            - 每一次迭代， $\tilde\lambda$ 继承上一次的。
            - 通常为 $\tilde\lambda$ 设置一个最小值，如果减小过了最小值，则需要重新选取初值计算。
        - **单点弦截法**
            - 基于构造法 2，$\lambda$ 的计算中，用割线的斜率代替导数，即 $\lambda = \dfrac{1}{\frac{\Delta y}{\Delta x}} = \dfrac{x_n - x_0}{f(x_n) - f(x_0)}$。
            - 迭代过程中，割线只有一个点变化，所以是单点弦截法。
            - 迭代公式为 $x_{n + 1} = \dfrac{x_0 f(x_n) - x_n f(x_0)}{f(x_n) - f(x_0)}$。
            - 在 $[a,b]$ 内的收敛条件：
                - $f(x)$ 在 $[a,b]$ 内二阶可导；
                - $f(a)f(b) < 0$；
                - $f'(x) \ne 0$，$f''(x)$ 不变号；
                - $f(x_0)f''(x_0) > 0$；
                - $f(x_0) \ne f(x_1)$。
            - 收敛阶为 $1$。
        - **双点弦截法**
            - 基于构造法 2 和单点弦截法，割线选取最后两个点的连线，$\lambda = \dfrac{1}{\frac{\Delta y}{\Delta x}} = \dfrac{x_n - x_{n - 1}}{f(x_n) - f(x_{n - 1})}$。
            - 迭代公式为 $x_{n + 1} = \dfrac{x_{n - 1} f(x_n) - x_n f(x_{n - 1})}{f(x_n) - f(x_{n - 1})}$。
            - 在 $[a,b]$ 内的收敛条件：
                - $f(x)$ 在 $[a,b]$ 内二阶可导；
                - $f(a)f(b) < 0$；
                - $f'(x) \ne 0$。
            - 收敛阶为 $\dfrac{1 + \sqrt 5}{2}$。
