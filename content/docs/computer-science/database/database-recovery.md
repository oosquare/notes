---
title: 数据库恢复
weight: 900
math: false
---

- **事务**
    - **特性**
        - 原子性、一致性、隔离性、持续性。
    - **状态**
        - 活动：事务正常执行时的状态。
        - 部分提交：事务中的所有语句全部完成，数据还在内存中，未永久写入。
        - 失败：事务无法成功执行。
        - 中止：事务出现失败后回滚后的状态。
        - 提交：数据写入，事务完成。
- **故障**
    - 系统故障：导致系统停止运行，需要重启。正在运行的事务非正常终止，内存数据丢失。
    - 事务故障：事务在提交前发生非预期的失败，应用程序无法处理。
    - 介质故障：储存设备发生故障。
- **恢复技术**
    - **数据转储**
        - **定义**
            - 定期将数据库复制到其他储存设备，故障发生后将副本重新装入。
        - **分类**
            - 静态和动态转储：
                - 静态转储时不响应用户事务。实现简单、降低可用性。
                - 动态转储时同时转储和响应用户事务。有并发性，不能保证数据正确有效。
            - 海量和增量转储：
                - 海量转储每次转储所有数据。恢复方便。
                - 增量转储只转储更新数据。转储性能更高。
    - **日志**
        - **定义**
            - 记录所有操作的信息，包括事务标识、操作、操作对象、数据值等。
        - **原则**
            - 日志登记要按照事务执行的时间顺序。
            - 先写日志再写数据库。
        - **方法**
            - 重做技术：按照日志重新执行事务。按照日志记录顺序重做。
            - 撤销技术：按照日志恢复数据到修改前。按照日志记录逆序撤销。
