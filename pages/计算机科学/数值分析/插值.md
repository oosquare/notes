---
tags:
  - computer-science
  - numeric-analysis
---
- **牛顿基本差商公式**
	- **差商**
		- 定义 $f(x)$ 的差商为 $f[x_0,x_1] = \dfrac{f(x_1)-f(x_0)}{x_1-x_0}$。
		- 定义 $f(x)$ 的 $n$ 阶差商为 $f[x_0,\dots,x_n] = \dfrac{f[x_0,\dots,x_{n-1}] - f[x_1,\dots,x_n]}{x_n-x_0}$。
		- 差商中任意几个点的顺序可以随意交换，即 $f[\dots,x_i,\dots,x_j,\dots] = [\dots,x_j,\dots,x_i,\dots]$。
		- 差商可以看作[[导数]]的离散形式。
	- **差商表**
		- ![](difference-quotient-table.png)
	- **公式**
		- 牛顿基本差商公式为 $P_n(x) = \displaystyle\sum_{i=0}^{n} f[x_0,\dots,x_i] \prod_{j=0}^{i-1} (x - x_j)$。原函数为 $f(x) = P_n(x) + R_n(x)$。
		- 展开形式：$P_n(x) = f(x_0) + (x - x_0)f[x_0,x_1] + (x - x_0)(x - x_1)f[x_0,x_1,x_2] + \cdots$。
		- 通过差商表计算，各阶差商从差商表的最上斜行得到。
	- **余式**
		- $R_n(x) = f(x) - P_n(x) = f[x_0,\dots,x_n,x]\displaystyle\prod_{i=0}^n(x-x_i)$。
		- 在给定区间中，存在 $\xi$ 使得 $f[x_0,\dots,x_n,x] = \dfrac{f^{(n+1)}(\xi)}{(n+1)!}$，即 $R_n(x) = \dfrac{f^{(n+1)}(\xi)}{(n+1)!}\displaystyle\prod_{i=0}^n(x-x_i)$。
		- 当 $x_0,\dots,x_n$ 趋于同一个值时，$R_n(x)$ 则为[[泰勒公式]]的拉格朗日余式。
		- 在给定区间中，如果 $|f^{(n+1)}(x)|$ 有上界 $M$，则估计 $|R_n(x)| \le \dfrac{M}{(n+1)!}\displaystyle\prod_{i=0}^n(x-x_i)$。
- **牛顿前插 / 后插公式**
	- **差分**
		- 定义 $y=f(x)$ 的差分 $\Delta y=f(x_1)-f(x_0)$，$n$ 阶差分为 $\Delta^{n}y_i = \Delta^{n-1} y_{i+1} - \Delta^{n-1}y_i$。
		- 差分同样可以使用差分表计算，类似差商表。
	- **牛顿前插公式**
		- 当插值节点等距、待求点在插值区间的较前部分时，使用牛顿前插公式比较合适。
		- 设插值节点间距为 $h$，$t = \dfrac{x-x_0}{h}$。
		- $P(x) = \displaystyle\sum_{i=0}^n \dfrac{\Delta^i y_0}{i!h^i} \prod_{j=0}^{i-1}(x-x_j) = \sum_{i=0}^n \binom{t}{i} \Delta^i y_0$。
		- $\Delta^i y_0$ 取差分表的最上斜行。
	- **牛顿后插公式**
		- 类似牛顿前插公式，但待求点在插值区间的较后部分。
		- 设 $t=\dfrac{x - x_n}{h}$，注意与前插公式中的区别。
		- $P(x) = \displaystyle\sum_{i=0}^n \dfrac{\Delta^i y_{n-i}}{i!h^i} \prod_{j=n-i+1}^n (x - x_j) =  \sum_{i=0}^n \binom{t+i-1}{i} \Delta^i y_{n-i}$。
- **拉格朗日公式**
	- **不等距节点公式**
		- $L_n(x) = \displaystyle\sum_{i=0}^n f(x_i) \prod_{j\ne i} \dfrac{x - x_j}{x_i - x_j} = \sum_{i=0}^n f(x_i) a_i(x)$。
		- $a_i(x) = \displaystyle\prod_{j\ne i} \dfrac{x - x_j}{x_i - x_j}$ 称为插值基函数。
			- 对于插值节点，$a_i(x_j) = \left\{\begin{matrix} 1, & i = j \\ 0,& i \ne j \end{matrix}\right.$。
			- $\displaystyle\sum_{i=0}^n a_i(x) = 1$ 恒成立。
	- **舍入误差估计**
		- $|\epsilon| = \displaystyle \left| \sum_{i=0}^n a_i(x)\Delta y_i + y_i\Delta a_i(x) \right| \le \sum_{i=0}^n \left(|a_i(x)| |\Delta y_i| + |y_i| |\Delta a_i(x)|\right)$。
		- 如果 $|\Delta y_i| = |\Delta a_i(x)| = \Delta$，则 $|\epsilon| \le  \sum_{i=0}^n (|\Delta y_i| + |\Delta a_i(x)|) \Delta$。
	- **等距节点公式**
		- 已知间距 $h,t=\dfrac{x-x_0}{h}$，$L_n(x) = \displaystyle\sum_{i=0}^n \dfrac{(-1)^{n-1} \prod_{j=0}^n (t-j)}{i!(n-i)!(t-i)}$。